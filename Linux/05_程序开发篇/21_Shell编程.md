# Shell编程
- 正则表达式
- Shell编程
## 正则表达式
- 正则表达式广泛应用在各种脚本语言中(解释型语言)包括Perl、PHP、Ruby和Python等，Linux的各种编程工具中也大量采用了正则表达式(Shell脚本编程)。
- “正则表达式”(regexps)又被称作“模式”(至少在Linux中是这样)，是被用来字符处理的一套规则;
  - 简而言之，正则表达式是一组对正在查找的文本的描述。
- 目前在GNU/Linux中有两套库可用于正则表达式编程：
  - POSIX库：是Linux自带的正则表达式库(Python中也使用这套标准);
  - PCRE库：是Perl的正则表达式库。
- 举个例子：匹配`/usr/share/dict/words`中“a开头、t结尾”的单词，采用命令如下：
```bash
$ egrep "^a.*t$" /usr/share/dict/words # egrep比grep支持更多正则表达式规则，此处grep也可以
# 如果我们要统计总的单词数
$ egrep '^a.*t$' /usr/share/dict/words | wc -c
```
- 正则表达式字符集：
  - `.`：匹配换行符之外的任意一个字符，`.`能匹配的字符范围是最大的;
  - `[]`：指定一个字符集，要求只能匹配其中的一个字符，如`[abc]`表示三选一;
  - `-`：连字符，和`[]`配合使用，如`[a-zA-Z]`表示匹配一个字母;
  - `\<`和`\>`：一对分隔符，表示匹配一个单词，注意**正则表达式中对单词的定义**指的是两侧由非单词字符分隔的字符串（非单词字符指的是字母、数字、下划线以外的任何字符）;
- 字符类：POSIX风格的正则表达式还提供预定义字符类来匹配某些特定的字符(但是很多类都可以用简单的正则表达式表示);
| 类 | 匹配字符 |
| --- | --- |
| [[:alnum:]] | 字母、数字字符 |
| [[:alpha:]] | 字母字符 |
| [[:lower:]] | 小写字母 |
| [[:upper:]] | 大写字母 |
| [[:digit:]] | 小数 |
| [[:xdigit:]] | 十六进制数字 |
| [[:punct:]] | 标点符号 |
| [[:blank:]] | 制表符和空格 |
| [[:space:]] | 空格 |
| [[:cntrl:]] | 所有控制符 |
| [[:print:]] | 所有可打印字符 |
| [[:graph:]] | 除空格外所有可打印字符 |
- 位置匹配：
  - `^`:用于匹配行首;
  - `$`:用于匹配行尾。
  - 所以如果要匹配一个空行就用`^$`，两者不必非要一起使用。
- 字符转义：
  - `\`：当要匹配特殊字符本身时，就在前加上转义字符，取消元字符本身的特殊含义。
- 重复：
  - `*`：表示在`*`前面的模式应该重复**0次或多次**;
  - `+`:表示模式重复**1次或多次**;
  - `?`:重复**0次或1次**;
  - `{n}`:模式重复n次;
  - `{n,}`:模式重复n次或更多;
  - `{n,m}`:模式不少于n次，不多于m次。
  - 一个例子，匹配不少于8位的数`\<[1-9][0-9]{7,}\>` 。
- 子表达式，i.e."分组"：
  - `()`:将部分字符组成一个字符组作为一个子模式，如"(or){2,}"表示整个子字符组重复2次以上，否则只重复紧挨的字符r。
- 反义(`^`在行首表示位置匹配，放括号内表示反义)：
  - `^`:除了此字符以外，全部都可以，和`[]`配合使用，表示除括号内字符的任意一个其他字符。如`[^ya]`表示除y和a以外的任一字符。
- 分支，或者叫“或”逻辑(一般正则表达式总是执行“与”逻辑，指同时满足给出的若干条件)：
  - `|`:如`^h|h$`表示h开头"或"h结尾，而`^hh$`表示h开头"且"h结尾(即'hh')，一个表达式中可以出现多个或逻辑`Jan(uary| |\.)`。
- 逆向引用：子表达式中捕获的内容可以在正则表达式的其他地方再次使用;
  - `\n`:'反斜杠+编号n'表示第n组子表示匹配到的内容，如`(\<*.\>).?( )*\1`可以匹配如'cart cart','ha!ha'这些字符组;
  - 从左到右，第i个出现的子表达式编号为i。

## Shell脚本编程
### hello world
- Shell因为分许多种类，严格说这里学习的应该BASH编程。
- Shell脚本语言不需要编译(并不能说'脚本语言一定不需要编译/解释型语言不需要编译')。
- 下面一个例子，告诉我们：
  - 第一行总是以`#!`开头，指定脚本的运行环境，`#! /bin/bash`告诉shell运行此脚本应该使用的shell(可以省略但不是一个好习惯);
  - `#`表示注释;
  - `echo`执行时会自动加上一个换行符;
  - 文本加上可执行权限之后才能变成脚本执行，`chmod a+x hello`。
```
#! /bin/bash
#Display a line

echo 'Hello world!' #echo会在最后自动加上一个换行符
```
### 变量和运算符
- 变量从诞生、消亡和作用范围：
  - Shell中变量使用之前不用事先声明(脚本语言貌似都如此);
  - `=`：赋值符号，如`var=1`就是给var赋值，**注意'='两边不能有空格**;
  - `$`:shell编程中用于对一个变量进行解析，表示取得变量的值;
  - `source`：一般变量只在其所在的"脚本"中有效，shell中不可见其值，但`source`命令可以**让一个脚本影响其父Shell环境**，使值在shell中可见;
  - `export`：可以让脚本影响其子shell环境;
  - `unset`:手动注销一个变量。
- 
