# 进程与线程
- 操作系统中最核心的概念是**进程**，这是对正在运行程序的一个抽象，操作系统的其他所有内容都是围绕着进程的概念展开的。
- 进程是操作系统提供的最古老的也是最重要的抽象概念之一。即使可以使用的CPU只有一个，但是它们也具有支持（伪）并发操作的能力，将一个单独的CPU变成多个虚拟的CPU。
## 进程
- 多道程序设计是指：在一台处理机上并发运行多个程序。**注意：并发不是同时，而是不同进程轮流使用CPU时间**。
- 在任何多道程序设计系统中，CPU由一个进程快速切换到另一个进程，使每个进程各运行几十或几百毫秒;
  - 严格地说，在某一个瞬间，CPU只能运行一个进程，但在一秒中内，可能运行多个进程，使得产生并行的错觉，这就是**伪并行**的情形。
  - 需要与之区分的是多处理器系统(有两个或多个CPU共享同一个屋里内存)的真正硬件并行。

### 进程模型
- 在进程模型中，计算机上的多有可运行的软件(包括操作系统)，被组织成若干顺序进程(sequential process)，简称进程。
  - 一个进程就是一个正在执行程序的实例，包括程序计数器、寄存器和变量的当前值。
  - 从概念上，每个进程拥有自己的虚拟CPU，实际上真正的CPU在各进程之间来回切换，因此考虑在伪并发情况下运行的进程集会比跟踪在程序之间的CPU切换简单得多。

- 一个CPU只能真正一次运行一个进程。
  - 由于CPU在各进程之间来回快速切换，所以每个进程执行运算的速度是不确定的;
  - 当一个进程具有严格的实时要求时，即某些事件必须在指定的若干毫秒内发生，那么必须采取特殊措施以保证它们一定在这段时间中发生。然而，**通常大多数进程并不受CPU多道程序设计或其他进程相对速度影响**。

- 进程和程序间的区别
  - 通常的说法是，进程是运行的程序。
  - 一个比方：假设做蛋糕的食谱是程序(用适当形式描述的算法)，烘焙师是处理器(CPU)，而做蛋糕的各种原料就是输入数据。那么进程就是出事阅读食谱，取来各种原料以及烘制蛋糕等一系列动作的总和。如果烘焙师的儿子突然哭着跑进来，说被蜜蜂蛰到了，那么烘焙师就记录下他照着食谱做到了哪里(保存进程的当前状态)，然后拿出一本急救手册，按照指示处理蛰伤。这里的CPU就从一个进程(做蛋糕)切换到另一个高优先级的进程(处理蛰伤)，每个进程拥各自的程序(食谱和急救手册)。当蛰伤处理完之后，烘焙师又继续做蛋糕，从离开时的那一步开始。
  - 上述例子的关键思想是，一个进程是某种类型的一个活动，有程序、输入、输出以及状态。单个处理器可以被若干进程共享，使用某种调度算法(包括进程优先级)决定何时停止一个进程的工作，转而为另一个进程提供服务。
  - **注意**:如果一个进程运行了两遍，则算作两个进程。

### 进程的创建
- 操作系统需要有一种方式来创建进程。只为运行一个应用程序而设计的操作系统，可能在系统启动之时，之后需要的所有进程都已存在。但在通用系统中，需要有某种方法在运行时按需创建或撤销进程。

- 4种主要事件会导致进程的创建：
  1. 系统初始化
  2. 正在运行的程序执行了创建进程的系统调用
  3. 用户请求创建一个心进程
  4. 一个批处理作业的初始化
- 启动操作系统时，会创建若干进程
  - 一些是前台进程：同用户交互并且替他们完成工作的进程。
  - 其他是后台进程，这些进程与特定用户无关，却具有某些专门的功能。
	- 停留在后台处理如电子邮件、web页面之类活动的进程称为守护进程(daemon)。
	- 在大型系统中通常会有很多守护进程，在UNIX下用`ps`查看正在运行的进程，win下用任务管理器。

- 一个正在运行的进程经常发出
