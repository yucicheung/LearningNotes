# 创建计算字段
## 摘要
- 介绍什么是计算字段
- 如何创建计算字段
- 计算字段在字符串拼接和算数计算中的用途
- 如何创建和使用别名，以便应用程序能引用计算字段。
## 计算字段

- 计算字段的应用场景：
  - 存储在数据库表中的数据一般不是应用程序所需要的格式，我们需要从数据库中检索出*转换、计算或格式化过的数据*，而不是检索出数据，然后在客户端应用程序中重新格式化。
- 计算字段并不实际存在于数据库表中，计算字段是运行时在SELECT语句内创建的。

- *字段(field)*
  - 基本上与列(column)的意思相同，经常互换使用，不过数据库列一般称为列，而术语字段一般与计算字段一起使用。
  - 只有数据库知道SELECT语句中哪些列是实际的表列，哪些是计算字段，对于客户端应用来说，列和计算字段的数据的返回方式是一致的。

- 提示：客户端与服务器的格式
  - 在SQL语句内可完成的许多转换和格式化工作都可以在客户端应用程序内完成，但一般来说，数据库服务器上完成会比在客户端完成会快很多。

## 拼接字段
- 拼接(Concatenate)
  - 将值联结到一起(将一个值附加到另一个值)构成单个值。
- 不同DBMS中的联结方法
  - `+`:在Access和SQL Server中使用`+`号;
  - `||`：在DB2、Oracle、PostgreSQL、SQLite和Open Office Base中使用`||`;
  - 在MariaDB和MySQL中，需要使用特定的拼接函数。
- 许多数据库(不是所有)保存填充为列宽的文本值(填充空格)，为正确返回格式化的数据，必须去掉多余空格，可以采用以下函数：
  - `RTRIM`:去除字符串右边的空格;
  - `LTRIM`:去除字符串左边的空格
  - `TRIM`:去除字符串两边的空格。
- 说明：TRIM函数
  - 大多数DBMS都支持上述3类`TRIM`函数。
### 别名
- 使用别名
  - 新计算列没有名字，它只是一个值;
  - 一个未命名的列不能用于客户端，因为客户端没有办法引用它。
- SQL支持别名(alias)：
  - *别名(alias)*是一个字段或值的替换名;
  - 别名用关键字`AS`赋予。
```sql
SELECT Concat(vend_name,'(',vend_country,')')
AS vend_title
FROM Vendors
ORDER BY vend_name;
```
- 上述语句指示SQL创建一个包含指定计算结果的名为vend_titlle的计算字段;此时，任何客户端应用都可以用这个名称引用这个列，就像它是个实际的表列一样。
- 说明：AS通常可选
  - 在很多DBMS中，AS关键字是可选的，不过最好使用它，这被视为一条最佳实践。
- 提示：别名的其他用途
  - 在实际表列名包含不合法字符(如空格)时重新命名它;
  - 在原来的名字含混或容易误解时扩充它。
- 注意：别名
  - 别名的名字既可以是**一个单词**(推荐)，也可以是一个字符串。
  - 字符串应该括在引号中，这样命名虽然是合法的，但是**不建议**，可能会给客户端带来各种问题;
  - 别名最常用的使用是将多个单词的列名重命名为一个单词的名字。
## 执行算数计算
- 计算字段的另一常见用途是对检索出的数据进行算数计算。
```sql
SELECT prod_id,quantity,item_price,quantity*item_price AS expanded_price
FROM OrderItems
WHERE order_num = 20008;
```
- SQL支持下表中列出的基本算数操作符，此外，圆括号可以用来区分优先顺序。

| 操作符 | 说明 |
| --- | --- |
| `+` | 加 |
| `-` | 减 |
| `*` | 乘 |
| `/` | 除 |

- 提示：如何测试计算
  - `SELECT`语句为测试、检验函数和计算提供了很好的方法;
  - `SELECT`语句省略`FROM`子句后就是简单的访问和处理表达式(带有`FROM`就自然是从表中检索数据)。
```sql
SELECT TRIM('ABD  ');
```
