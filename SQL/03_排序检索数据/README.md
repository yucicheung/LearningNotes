# 排序检索数据

## 摘要
- 使用SELECT语句的`ORDER BY`子句对检索出的数据进行排序。
- `ORDER BY`子句必须是`SELECT`语句中的最后一条子句。
- 根据需要，它可以用来在一个或多个列上对数据进行排序。

## 排序数据
- 在没有明确指定顺序时，检索到的数据并没有特定的顺序，**但这个顺序并不是随机显示的**。如果不排序，数据一般**以它在底层表中出现的顺序显示**：
  - 可能是数据最初添加到表中的顺序;
  - 但是在数据进行过更新或删除后，这个顺序会受到DBMS重用回收存储空间的方式的影响;
  - 关系数据库设计理论认为，如果不明确规定排序顺序，则不应该假定检索出的数据顺序有任何意义。
- *子句(clause)*
  - SQL语句由子句构成，有些子句是必须的，有些则是可选的;
  - 一个子句通常由一个关键词加上所提供的数据组成;
  - 比如SELECT中的`FROM`就是子句，它是可选的子句，后续的`ORDER BY`也是可选的子句。
- `ORDER BY`子句：取一个或多个列的名字，据此对输出进行排序。
- 注意：ORDER BY子句的位置
  - 指定ORDER BY子句时，应**保证它是SELECT语句中最后一条子句**，否则会出错。
- 提示：通过非选择列进行排序
  - 用非检索的列排序数据完全是合法的。

## 按多个列进行排序
- 要按多个列排序，简单指定列名，列名之间用逗号分隔，例子如下：
```sql
SELECT prod_name
FROM Products
ORDER BY vend_id,prod_name;
```

- 将首先按照`ORDER BY`后vend_id排序，再按prod_name排序;如果vend_id列中所有值都唯一，则不会按照prod_name排序。

## 按列位置排序
- `ORDER BY`还支持按相对列位置进行排序(不指定别名而指定相对列)。
```sql
SELECT prod_id, prod_price, prod_name
FROM Products
ORDER BY 2,3
```
- 按列位置排序的好处是：不用重新输入别名。
- 按列位置排序的缺点：
  - 不明确给出列名可能导致错用列名排序;
  - 对SELECT清单进行更改时，可能忘记调整`ORDER BY`子句，造成对数据进行错误排序;
  - 如果排序要使用的列不在SELECT清单中，显然不能使用这个技术。
- 提示：按非选择列排序
  - 如果有必要，可以混合使用实际列明和相对列位置。
## 指定排序方向
- 升序排序(A到Z)是默认排序顺序;
  - 关键字是`ASC`或`ASCENDING`，但由于是默认顺序，这个关键字用处不大。
- 降序排序(从Z到A);
  - 需要指定`DESC`关键字`SELECT prod_name,prod_id,prod_price FROM Products ORDER BY prod_price DESC, prod_name`
- 警告：在多个列上降序排序
  - `DESC`关键字只应用到直接位于其前面的别名;
  - 如果要对多个列进行降序排序，必须对每一列指定`DESC`关键字。
  - `DESCENDING`也是关键字，但是在MySQL不适用。
- 提示：区分大小写和排序顺序
  - 如A和a是否相同，a在B之前还是Z之后这些问题，**由数据库的设置方式决定**;
  - 在字典排序顺序中，A被视为和a相同，这是大多数DBMS的默认行为;
  - 大多DBMS是允许数据库管理员改变这种默认行为的(如果数据库包含大量外语字符，修改默认行为是必须的)，因此要改变这种排序顺序需要请求数据库管理员的帮助。
